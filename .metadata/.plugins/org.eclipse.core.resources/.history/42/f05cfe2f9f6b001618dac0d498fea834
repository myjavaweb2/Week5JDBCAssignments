package com.airhacks;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;
import java.util.ArrayList;

public class DAO {
	
	static final String DB_URL = "jdbc:mysql://localhost:3306/?user=root&autoReconnect=true&useSSL=false";
	static final String USER = "root";
	static final String PASSWORD = "root";
	
	static Connection CONN = null;
	static Statement STMT = null;
	static PreparedStatement PREP_STMT = null;
	static ResultSet RES_SET = null;
	
	public static void connectToDatabase () {
		
		try {
			System.out.println("Trying to connect to the database...");
			CONN = DriverManager.getConnection(DB_URL, USER, PASSWORD);
			System.out.println("Connected to the database.");
		} catch (SQLException e) {
			System.out.println("Cannot connect to the database.");
			e.printStackTrace();
		}
	}//connectToDatabase
	
	public static void readFromDatabase () {
		
		connectToDatabase();
		
		ArrayList<Employee> companyEmployees = new ArrayList<>();
		
		try {
			STMT = CONN.createStatement();
			RES_SET = STMT.executeQuery("SELECT * FROM company.employees;");
			
			while (RES_SET.next()) {
				
				Employee employeeInDatabase = new Employee();
				
				employeeInDatabase.setEmployeeID(RES_SET.getString("employee_id"));
				employeeInDatabase.setFirstName(RES_SET.getString("first_name"));
				employeeInDatabase.setLastName(RES_SET.getString("last_name"));
				employeeInDatabase.setPosition(RES_SET.getString("position"));
				employeeInDatabase.setSalary(RES_SET.getDouble("salary"));
				
				companyEmployees.add(employeeInDatabase);
				
			}
			
			for (Employee employee : companyEmployees) {
				
				System.out.println(employee.toString());
				
			}
		} catch (SQLException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		
		
	}//readFromDatabase

	
}//DAO class
